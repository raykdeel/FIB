else if (datos$stat[i] == 1) {
frecB1 = frecB1 + 1;
}
else if (datos$stat[i] == 2) {
frecB2 = frecB2 + 1;
}
}
}
frecA0; frecB0 	# columna 1
frecA1; frecB1	# columna 2
frecA2; frecB2 	# columna 3
# PREGUNTA 2
nA = nA0+nA1+nA2; nA
nB = nB0+nB1+nB2; nB
n0 = nA0+nB0; n0
n1 = nA1+nB1; n1
n2 = nA2+nB2; n2
eA0 = nA*n0/n; eA0	# Simplex y óptima
eA1 = nA*n1/n; eA1	# Simplex y subóptima
eA2 = nA*n2/n; eA2	# Simplex y imposible
eB0 = nB*n0/n; eB0	# Punto interior y óptima
eB1 = nB*n1/n; eB1	# Punto interior y subóptima
eB2 = nB*n2/n; eB2	# Punto interior y imposible
### Exercici 2 ###
# ¿Cuál sería el número esperado de observaciones, si en cuanto al estado final
# los dos procedimientos respondieran sin diferencias en su distribución?
totalA <- frecA0 + frecA1 + frecA2
totalB <- frecB0 + frecB1 + frecB2
total0 <- frecA0 + frecB0
total1 <- frecA1 + frecB1
total2 <- frecA2 + frecB2
espA0 <- n * (totalA/n) * (total0/n)
eA0 = nA*n0/n; eA0	# Simplex y óptima
# PREGUNTA 2
nA = nA0+nA1+nA2; nA
nB = nB0+nB1+nB2; nB
n0 = nA0+nB0; n0
n1 = nA1+nB1; n1
n2 = nA2+nB2; n2
c(nA0,nB0,nA1,nB1,nA2,nB2)
table(dades)
n = length(dades$V2); n
dades
# PREGUNTA 1
nA0 = 0
nA1 = 0
nA2 = 0
nB0 = 0
nB1 = 0
nB2 = 0
for (i in 1:n) {
if (dades$V2[i] == 'A') {
if (dades$V3[i] == 0) {
nA0 = nA0 + 1;
}
else if (dades$V3[i] == 1) {
nA1 = nA1 + 1;
}
else if (dades$V3[i] == 2) {
nA2 = nA2 + 1;
}
}
else {
if (dades$V3[i] == 0) {
nB0 = nB0 + 1;
}
else if (dades$V3[i] == 1) {
nB1 = nB1 + 1;
}
else if (dades$V3[i] == 2) {
nB2 = nB2 + 1;
}
}
}
c(nA0,nB0,nA1,nB1,nA2,nB2)
c(nA0,nB0,nA1,nB1,nA2,nB2)
nB0
for (i in 1:n) {
if (dades$V2[i] == 'A') {
if (dades$V3[i] == 0) {
nA0 = nA0 + 1;
}
else if (dades$V3[i] == 1) {
nA1 = nA1 + 1;
}
else if (dades$V3[i] == 2) {
nA2 = nA2 + 1;
}
}
else {
if (dades$V3[i] == 0) {
nB0 = nB0 + 1;
}
else if (dades$V3[i] == 1) {
nB1 = nB1 + 1;
}
else if (dades$V3[i] == 2) {
nB2 = nB2 + 1;
}
}
}
frecA0; frecB0 	# columna 1
frecA1; frecB1	# columna 2
frecA2; frecB2 	# columna 3
table(dades)
# PREGUNTA 2
nA = nA0+nA1+nA2; nA
# PREGUNTA 2
nA = 51+56+51; nA
nB = 62+78+21; nB
n0 = 51+62; n0
n1 = 56+76; n1
n2 = 51+21; n2
eA0 = nA*n0/n; eA0	# Simplex y óptima
### Exercici 2 ###
# ¿Cuál sería el número esperado de observaciones, si en cuanto al estado final
# los dos procedimientos respondieran sin diferencias en su distribución?
totalA <- frecA0 + frecA1 + frecA2
totalB <- frecB0 + frecB1 + frecB2
total0 <- frecA0 + frecB0
total1 <- frecA1 + frecB1
total2 <- frecA2 + frecB2
espA0 <- n * (totalA/n) * (total0/n)
# PREGUNTA 3
xA0 = (nA0-eA0)^2/eA0
xA1 = (nA1-eA1)^2/eA1
xA2 = (nA2-eA2)^2/eA2
xB0 = (nB0-eB0)^2/eB0
xB1 = (nB1-eB1)^2/eB1
xB2 = (nB2-eB2)^2/eB2
X = xA0+xA1+xA2+xB0+xB1+xB2; X
eA0 = nA*n0/n; eA0	# Simplex y óptima
eA1 = nA*n1/n; eA1	# Simplex y subóptima
eA2 = nA*n2/n; eA2	# Simplex y imposible
eB0 = nB*n0/n; eB0	# Punto interior y óptima
eB1 = nB*n1/n; eB1	# Punto interior y subóptima
eB2 = nB*n2/n; eB2	# Punto interior y imposible
# PREGUNTA 3
xA0 = (nA0-eA0)^2/eA0
xA1 = (nA1-eA1)^2/eA1
xA2 = (nA2-eA2)^2/eA2
xB0 = (nB0-eB0)^2/eB0
xB1 = (nB1-eB1)^2/eB1
xB2 = (nB2-eB2)^2/eB2
X = xA0+xA1+xA2+xB0+xB1+xB2; X
# PREGUNTA 4
graus = (2-1)*(3-1); graus
P = 1-pchisq(X,graus)				# si P < 0.05
pcritic = qchisq(0.95,graus); pcritic	# si X > pcritic
P
pearson <- (((frecA0-espA0)^2)/espA0)+(((frecA1-espA1)^2)/espA1)+(((frecA2-espA2)^2)/espA2)+(((frecB0-espB0)^2)/espB0)+(((frecB1-espB1)^2)/espB1)+(((frecB2-espB2)^2)/espB2)
pearson
espA0 <- n * (totalA/n) * (total0/n)
espA1 <- n * (totalA/n) * (total1/n)
espA2 <- n * (totalA/n) * (total2/n)
espB0 <- n * (totalB/n) * (total0/n)
espB1 <- n * (totalB/n) * (total1/n)
espB2 <- n * (totalB/n) * (total2/n)
pearson <- (((frecA0-espA0)^2)/espA0)+(((frecA1-espA1)^2)/espA1)+(((frecA2-espA2)^2)/espA2)+(((frecB0-espB0)^2)/espB0)+(((frecB1-espB1)^2)/espB1)+(((frecB2-espB2)^2)/espB2)
pearson
n <- length(datos$met)
### Exercici 1 ###
# Complete la tabla de frecuencias
frecA0 <- 0; frecA1 <- 0; frecA2 <- 0
frecB0 <- 0; frecB1 <- 0; frecB2 <- 0
for (i in 1:n) {
if (datos$met[i] == 'A') {
if (datos$stat[i] == 0) {
frecA0 = frecA0 + 1;
}
else if (datos$stat[i] == 1) {
frecA1 = frecA1 + 1;
}
else if (datos$stat[i] == 2) {
frecA2 = frecA2 + 1;
}
}
else {
if (datos$stat[i] == 0) {
frecB0 = frecB0 + 1;
}
else if (datos$stat[i] == 1) {
frecB1 = frecB1 + 1;
}
else if (datos$stat[i] == 2) {
frecB2 = frecB2 + 1;
}
}
}
frecA0; frecB0 	# columna 1
frecA1; frecB1	# columna 2
frecA2; frecB2 	# columna 3
### Exercici 2 ###
# ¿Cuál sería el número esperado de observaciones, si en cuanto al estado final
# los dos procedimientos respondieran sin diferencias en su distribución?
totalA <- frecA0 + frecA1 + frecA2
totalB <- frecB0 + frecB1 + frecB2
total0 <- frecA0 + frecB0
total1 <- frecA1 + frecB1
total2 <- frecA2 + frecB2
espA0 <- n * (totalA/n) * (total0/n)
espA1 <- n * (totalA/n) * (total1/n)
espA2 <- n * (totalA/n) * (total2/n)
espB0 <- n * (totalB/n) * (total0/n)
espB1 <- n * (totalB/n) * (total1/n)
espB2 <- n * (totalB/n) * (total2/n)
pearson <- (((frecA0-espA0)^2)/espA0)+(((frecA1-espA1)^2)/espA1)+(((frecA2-espA2)^2)/espA2)+(((frecB0-espB0)^2)/espB0)+(((frecB1-espB1)^2)/espB1)+(((frecB2-espB2)^2)/espB2)
pearson
5.442855
# podemos usar:
puntcritic <- qchisq(0.95,2)
puntcritic
pearson
# Escribir el que nos pidan de estos 3 segun:
#	- A = Simplex, B = Punto Interior
#	- 0 = optimo, 1 = subóptimo, 2 = imposible
#optimo:
propA0 <- frecA0/(totalA)
# podemos usar:
puntcritic <- qchisq(0.95,2)
puntcritic
pearson
c(1/5)		# si P > 0.2 => escasa
P
# PREGUNTA 3
xA0 = (nA0-eA0)^2/eA0
xA1 = (nA1-eA1)^2/eA1
xA2 = (nA2-eA2)^2/eA2
xB0 = (nB0-eB0)^2/eB0
xB1 = (nB1-eB1)^2/eB1
xB2 = (nB2-eB2)^2/eB2
X = xA0+xA1+xA2+xB0+xB1+xB2; X
# PREGUNTA 4
graus = (2-1)*(3-1); graus
P = 1-pchisq(X,graus)				# si P < 0.05
# podemos usar:
puntcritic <- qchisq(0.95,2)
puntcritic
pearson
# Escribir el que nos pidan de estos 3 segun:
#	- A = Simplex, B = Punto Interior
#	- 0 = optimo, 1 = subóptimo, 2 = imposible
#optimo:
propA0 <- frecA0/(totalA)
propB0 <- frecB0/(totalB)
propA0; propB0
### Exercici 6 ###
# Suponiendo la hipótesis H
# 		   H:	la proporción de resultados de tipo imposible es la
#		   	misma para ambos métodos
# ¿cuál es la estimación de la probabilidad común que presenta este tipo
# de resultado?
# Escribir el que nos pidan de estos 3 segun:
#	- A = Simplex, B = Punto Interior
#	- 0 = optimo, 1 = subóptimo, 2 = imposible
#optimo:
probcomun <- espA0/(espA0+espA1+espA2)
probcomun2 <- espB0/(espB0+espB1+espB2)
probcomun
probcomun2	# Solo se hace para comprobar que sean iguales
### Exercici 7 ###
# Calcule el error tipo correspondiente a la diferencia de dos proporciones,
# bajo el supuesto de la hipótesis H.
n1 <- totalA
n2 <- totalB
#optimo:
P1 <- frecA0/(frecA0+frecA1+frecA2)
P2 <- frecB0/(frecB0+frecB1+frecB2)
#optimo:
P1 <- frecA0/(frecA0+frecA1+frecA2)
P2 <- frecB0/(frecB0+frecB1+frecB2)
P <- (n1*P1 + n2*P2)/(n1+n2)
error <- sqrt(P*(1-P)/n1 + P*(1-P)/n2)
error
z <- (P1-P2)/error
z
pvalor <- 2*(1-pnorm(z))  #si z >0
pvalor <- 2*(pnorm(z)) 	  #si z < 0
pvalor
dades <- read.table("clipboard",header=TRUE)
dades1 <- read.table("clipboard",header=TRUE)
dades2 <- read.table("clipboard",header=TRUE)
n1 = length(dades1$Peso)
n2 = length(dades2$Peso)
n1
n2
dades
dades1
dades2
dades <- read.table("clipboard",header=TRUE)
dades1 <- read.table("clipboard",header=TRUE)
n1 = length(dades1$Peso)
n1
dades2 <- read.table("clipboard",header=TRUE)
n1 = length(dades1$Peso)
n2 = length(dades2$Peso)
n1
n2
dades2
dades2 <- read.table("clipboard",header=TRUE)
n1 = length(dades1$Peso)
n2 = length(dades2$Peso)
n1
n2
dades2
dades11
dades1
# PREGUNTA 1
s2Z = ((n1-1)*var(dades1$Z)+(n2-1)*var(dades2$Z))/(n1+n2-2); s2Z
dades1 <- read.table("clipboard",header=TRUE)
dades2 <- read.table("clipboard",header=TRUE)
n1 = length(dades1$Peso)
n2 = length(dades2$Peso)
n1
n2
dades1
# PREGUNTA 1
s2Z = ((n1-1)*var(dades1$Z)+(n2-1)*var(dades2$Z))/(n1+n2-2); s2Z
# PREGUNTA 2
mu1Z = mean(dades1$Z); mu1Z
mu2Z = mean(dades2$Z); mu2Z
t = (mu1Z-mu2Z)/(sZ*sqrt(1/n1+1/n2)); t
P = 2*(1-pt(t,n1+n2-2)); P
P = 2*pt(t,n1+n2-2); P
# PREGUNTA 3
alfa = 0.01
sd1Z = sd(dades1$Z); sd1Z
sd2Z = sd(dades2$Z); sd2Z
var1Z = var(dades1$Z); var1Z
var2Z = var(dades2$Z); var2Z
F = var2Z/var1Z; F
pcritic = qf(1-alfa/2,n1-1,n2-1); pcritic
pcritic = qf(1alfa/2,n1-1,n2-1); pcritic
-
F = var2Z/var1Z; F
pcritic = qf(1-alfa/2,n1-1,n2-1); pcritic
pcritic = qf(1-alfa/2,n1-1,n2-1); pcritic
# PREGUNTA 3
alfa = 0.01
sd1Z = sd(dades1$Z); sd1Z
sd2Z = sd(dades2$Z); sd2Z
var1Z = var(dades1$Z); var1Z
var2Z = var(dades2$Z); var2Z
F = var2Z/var1Z; F
pcritic = qf(1-alfa/2,n1-1,n2-1); pcritic
n1 = length(dades1$Peso)
n2 = length(dades2$Peso)
n1
n2
dades1
# PREGUNTA 1
s2Z = ((n1-1)*var(dades1$Z)+(n2-1)*var(dades2$Z))/(n1+n2-2); s2Z
sZ = sqrt(s2Z); sZ
# PREGUNTA 2
mu1Z = mean(dades1$Z); mu1Z
mu2Z = mean(dades2$Z); mu2Z
t = (mu1Z-mu2Z)/(sZ*sqrt(1/n1+1/n2)); t
P = 2*(1-pt(t,n1+n2-2)); P
P = 2*pt(t,n1+n2-2); P
# PREGUNTA 3
alfa = 0.01
sd1Z = sd(dades1$Z); sd1Z
sd2Z = sd(dades2$Z); sd2Z
var1Z = var(dades1$Z); var1Z
var2Z = var(dades2$Z); var2Z
F = var2Z/var1Z; F
pcritic = qf(1-alfa/2,n1-1,n2-1); pcritic
# PREGUNTA 4
# Y => mitja taronja per 1 y mitja taronja per 2 => APARELLADES
D = dades1$Y-dades2$Y; D
t = mean(D)/(sd(D)/sqrt(length(D))); t
P = 2*(1-pt(t,length(D)-1)); P
P = 2*pt(t,length(D)-1); P
dades1 <- read.table("clipboard",header=TRUE)
dades2 <- read.table("clipboard",header=TRUE)
n1 = length(dades1$Peso)
n2 = length(dades2$Peso)
n1
n2
dades1
# PREGUNTA 1
s2Z = ((n1-1)*var(dades1$Z)+(n2-1)*var(dades2$Z))/(n1+n2-2); s2Z
sZ = sqrt(s2Z); sZ
# PREGUNTA 2
mu1Z = mean(dades1$Z); mu1Z
# PREGUNTA 3
alfa = 0.01
sd1Z = sd(dades1$Z); sd1Z
sd2Z = sd(dades2$Z); sd2Z
var1Z = var(dades1$Z); var1Z
var2Z = var(dades2$Z); var2Z
F = var2Z/var1Z; F
pcritic = qf(1-alfa/2,n1-1,n2-1); pcritic
# PREGUNTA 4
# Y => mitja taronja per 1 y mitja taronja per 2 => APARELLADES
D = dades1$Y-dades2$Y; D
t = mean(D)/(sd(D)/sqrt(length(D))); t
P = 2*(1-pt(t,length(D)-1)); P
P = 2*pt(t,length(D)-1); P
# PREGUNTA 5
prob = 0.80
alfa = 1-prob; alfa
t = qt(1-alfa/2,n1+n2-2); t
c(mu1Z-mu2Z-t*sZ*sqrt(1/n1+1/n2),mu1Z-mu2Z+t*sZ*sqrt(1/n1+1/n2))
D = dades1$Z-dades2$Z; D
t = qt(1-alfa/2,length(D)-1); t
c(mean(D)-t*sd(D)*sqrt(1/length(D)),mean(D)+t*sd(D)*sqrt(1/length(D)))
datos <- read.delim("clipboard")
datos
n = length(datos$Humedad.drcho.)
Humedadnew <- c()
Humedadold <- c()
for (i in 1:n) {
if (datos$Ojo.new[i] == 'Drcho') {
Humedadnew <- c(Humedadnew, datos$Humedad.drcho.[i]);
Humedadold <- c(Humedadold, datos$Humedad.izqdo.[i]);
}
else {
Humedadnew <- c(Humedadnew, datos$Humedad.izqdo.[i]);
Humedadold <- c(Humedadold, datos$Humedad.drcho.[i]);
}
}
for (i in 1:n) {
if (datos$Ojo.new[i] == 'Drcho') {
Humedadnew <- c(Humedadnew, datos$Humedad.drcho.[i]);
Humedadold <- c(Humedadold, datos$Humedad.izqdo.[i]);
}
else {
Humedadnew <- c(Humedadnew, datos$Humedad.izqdo.[i]);
Humedadold <- c(Humedadold, datos$Humedad.drcho.[i]);
}
}
n = length(datos$Humedad.drcho.)
datos <- read.delim("clipboard")
datos
n = length(datos$Humedad.drcho.)
Humedadnew <- c()
Humedadold <- c()
for (i in 1:n) {
if (datos$Ojo.new[i] == 'Drcho') {
Humedadnew <- c(Humedadnew, datos$Humedad.drcho.[i]);
Humedadold <- c(Humedadold, datos$Humedad.izqdo.[i]);
}
else {
Humedadnew <- c(Humedadnew, datos$Humedad.izqdo.[i]);
Humedadold <- c(Humedadold, datos$Humedad.drcho.[i]);
}
}
#1
r1 = mean(Humedadnew)
r1
datos <- read.delim("clipboard")
datos
n = length(datos$Humedad.drcho.)
Humedadnew <- c()
Humedadold <- c()
for (i in 1:n) {
if (datos$Ojo.new[i] == 'Drcho') {
Humedadnew <- c(Humedadnew, datos$Humedad.drcho.[i]);
Humedadold <- c(Humedadold, datos$Humedad.izqdo.[i]);
}
else {
Humedadnew <- c(Humedadnew, datos$Humedad.izqdo.[i]);
Humedadold <- c(Humedadold, datos$Humedad.drcho.[i]);
}
}
# El izquierda/derecha en la fila indica en que columna
# está el valor de la humedad de las lentillas New
New = c(40.9,32.9,45.2,27.4,49.3,36.8,56.7,57.6,45.3,61.5,64.7,42,56.8,99.4)
Ref = c(29,23.2,42.4,34.2,27.8,32.9,46.1,49.2,42.4,54,53.4,32.4,45.6,100.2)
nN = length(New); nN
nR = length(Ref); nR
# PREGUNTA 1
muN = mean(New); muN
muR = mean(Ref); muR
New
# El izquierda/derecha en la fila indica en que columna
# está el valor de la humedad de las lentillas New
New = c(52.8,49.6,58.9,55,40.6,31.6,40,59.6,44.2,46)
Ref = c(51.5,45.2,66.8,57.6,37.9,37.8,42.1,72.7,47.6,44.7)
nN = length(New); nN
nR = length(Ref); nR
New
# PREGUNTA 1
muN = mean(New); muN
muR = mean(Ref); muR
# PREGUNTA 2
D = New-Ref; D
muD = mean(D); muD
# PREGUNTA 1
muN = mean(New); muN
muR = mean(Ref); muR
# PREGUNTA 3
sD = sd(D); sD
# PREGUNTA 4
nD = length(D)
se = sD/sqrt(nD); se
# PREGUNTA 5
t = muD/(sD/sqrt(nD)); t
# PREGUNTA 6
grados = nD-1; grados
# PREGUNTA 7
P = 2*(1-pt(t,grados)); P	# t>=0
P = 2*pt(t,grados); P		# t<0
# PREGUNTA 8
alfa5 = 0.05	# si P<alfa1 => rechazar H0 con alfa5
alfa1 = 0.01	# si P<alfa1 => rechazar H0 con alfa1
# PREGUNTA 9
prob = 0.85
alfa = 1-prob; alfa
t = qt(1-alfa/2,nD-1); t
c(muD-t*sD/sqrt(nD),muD+t*sD/sqrt(nD))
